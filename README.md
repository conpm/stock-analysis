# stock-analysis
---
# Analysis of Green Stocks in 2017 & 2018
## Overview of Project
### Purpose
The purpose of this project was to perform an analysis on a variety of green stocks in order to determine how the stocks have performed over 2017 & 2018 searching for two major criteria.  The first was the total of daily trading volume and the second was the percentage return on the stock over the course of the year.  This analysis can then be used in order to advise on current investments as well as to guide potential future investments.
## Results
### Performing the Analysis
In order to perform this analysis, the data needed to be processed in a way that would return "Total Daily Volume" and "Return %" values for each of the green stocks.  The first step in this process was to create an array which held the names of each of the different stock tickers.  This array can then be used in order to separate the data linked with each stock ticker.  Next, a tickerIndex was created in order to reference which element within the tickers array is currently being used.  Then, three more arrays were created in order to store specific information related to each ticker, these arrays were for ticker startingPrices, ticker endingPrices, and tickerVolumes.  Now, using a For loop to loop over all the rows in the spreadsheet, we are able to populate these arrays with values corresponding to the current tickerIndex being referenced.  This process repeats for each element in the tickerIndex until values have been calculated for each stock.  Next, The information held in the arrays is then used to output data into the All Stocks Analysis spreadsheet.  The tickerVolume is put directly into the Total Daily Volume column, while the Return % is calculated by taking the endingPrices() / startingPrices() - 1.  Lastly, the All Stocks Analysis spreadsheet is formatted and color coded in order to make it more easily legible.
### 2017
![VBA_Challenge_2017](https://github.com/conpm/stock-analysis/blob/main/Resources/VBA_Challenge_2017.PNG)

Using the information from the analysis of green stocks in 2017, we can see that all but one of the stocks being analyzed saw positive returns over the year.  With "DQ", "ENPH", "FSLR" and "SEDG" all seeing returns of over 100%.
### 2018
![VBA_Challenge_2018](https://github.com/conpm/stock-analysis/blob/main/Resources/VBA_Challenge_2018.PNG)

The 2018 analysis shows a much different picture for green stocks, as the only stocks which had positive returns in this year were "ENPH" and "RUN".  Additionally, when looking at the two analyses side by side, there is a big difference in the total daily volumes betwenen the two years.  Stocks which saw an increase in total daily volume were likely traded more frequently during 2018 than 2017, with the opposite being true of stocks which saw a decrease in total daily volume.

## Summary
There are many different advantages to refactoring script, the first and most clear from this process seems to be that you can make code run more efficiently, which becomes more and more impactful the bigger the dataset is thats being analyzed.  Additionally, by refactoring code it is possible to remove any static variables, so that if you wanted to adjust the code in order to accomodate additional datapoints, it would be relatively easy by changing variable values in one place rather than throughout the entirety of the code.  Also, refactoring code can help to give a deeper understanding of what the code is doing so that you are able to utilize any optimizations in the future on the initial creation of your code.  A disadvantage I could see with refactoring code, is that if it is done without a thorough understanding of the previous version of the code, it is possible to cause more problems in the code as you try to optimize it.

In the specific example of the code used in this analysis, a big advantage of the refactored code was that it combined several macros into one, therefore allowing you to format the output sheet, gather the specified data, and populate the output sheet with properly the properly formatted data all in one macro.  Previously, in the version of the code I had written, I needed to perform two separate macros in order to populate the output sheet and then format those results.  Additionally, this code was able to perform much more quickly by using 3 output arrays to store data for all variables, and then accessing the stored data in the arrays to output the data.  Rather than how it was previously set up where the code would peform the analysis and output the results all at once using nested For loops.  The only disadvantage I found in this specific example was that by combing all of the macros into one macro, it became somewhat more difficult to determine the cause of errors, as there is more code to look through.
